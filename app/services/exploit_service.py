from typing import Any
from .dbs.databases import get_collection


async def read_exploits_by_cve_id(cve: str) -> list[dict[str, Any]]:
    exploit_db_collection = get_collection('exploit_db')
    pipeline = [
        {
            '$project': {
                '_id': 0,
                'id': 1,
                'cves': 1
            }
        },
        {
            '$match': {
                'cves': {'$in': [cve]}
            }
        }
    ]
    try:
        return [exploit['id'] async for exploit in exploit_db_collection.aggregate(pipeline)]
    except:
        return []